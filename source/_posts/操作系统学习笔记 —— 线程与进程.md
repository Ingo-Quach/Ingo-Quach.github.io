---
abbrlink: ''
categories:
- - 大学生涯
cover: https://cdn.jsdelivr.net/gh/Ingo-Quach/webTuChuang@main/Qexo/25/8/OS%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B_84046c4d780a8b010da039ae8f416ef6.png
date: '2025-08-12T21:24:14.964567+08:00'
tags:
- 操作系统
title: 操作系统学习笔记 —— 线程与进程
top_img: https://cdn.jsdelivr.net/gh/Ingo-Quach/webTuChuang@main/Qexo/25/8/OS%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B_84046c4d780a8b010da039ae8f416ef6.png
updated: '2025-08-12T21:54:57.743+08:00'
---
# 线程 VS 进程

* 线程共享所属进程的状态和资源，它们驻留在同一个地址空间，可以访问到相同的数据
* 调度：在传统 OS 中，进程是调度和分配资源的基本单位；引入线程后，线程才是
* 拥有资源：进程是拥有资源的基本单位；多个线程共享同一进程的资源
* 并发性：进程之间可以并发执行；同一进程中的各线程之间也可以并发执行
* 系统开销：进程创建、撤销及切换的开销大于线程

### 多线程程序设计

多线程：是指从软件或者硬件上实现多个线程并发执行的技术

* 多线程技术可以加快程序的运行速度，使程序的响应速度更快，因为用户界面可以在进行其它工作的同时一直处于活动状态。
* 可以把占据长时间的程序中的任务放到后台去处理，同时执行其他操作，提高效率。
* 当前没有进行处理的任务时可以将处理器时间让给其它任务。
* 可以让同一个程序的不同部分并发执行，释放一些珍贵的资源如内存占用等等。
* 可以随时停止任务。
* 可以分别设置各个任务的优先级以优化性能。

### 多线程与多进程的优缺点

#### 多进程：

* **优点：**
  * 独立执行：每个进程都有自己独立的一块内存空间， 互不影响， 适合资源密集型任务， 如I/O操作。
  * 安全性：进程间的通信通常通过文件、管道或消息队列等机制， 隔离性强， 避免数据竞争。
* **缺点：**
  * 开销大：创建新进程需要操作系统分配大量资源， 包括内存拷贝。
  * 切换成本高： 进程间切换比线程切换更耗时。
  * 不适合共享数据：因为每个进程都有独立内存， 直接修改共享数据较复杂。

#### 多线程：

* **优点：**
  * 高效：内存共享使得线程切换速度快于进程切换， 提高了程序响应速度。
  * 同步方便：线程间可以直接访问共享数据， 通过锁或其他同步机制处理并发。
  * 易于编程：相对于进程， 创建和管理线程相对简单。
* **缺点：**
  * 上下文切换：如果过多线程争夺同一资源， 可能导致上下文切换频繁， 影响性能。
  * 全局变量风险： 跨线程修改全局变量可能导致数据一致性问题。
  * 死锁：当多个线程互相等待对方释放资源时， 可能会发生死锁。

## 用户级线程vs 内核级线程（优缺点）

### 内核级线程

* 依赖于内核，由操作系统内核完成创建和撤销工作的线程
* 在支持内核级线程的 OS 中，由内核维护进程和线程的上下文信息并完成线程切换
* 一个内核级线程阻塞时不会影响到其他线程的运行
* 处理机时间分配对象是线程，所以有多个线程的进程将获得更多处理机时间
* 限制：
  * 内核级线程的控制需要通过系统调用实现，频繁的模式切换会导致性能下降

#### 优缺点——内核级线程

优点：

* 内核线程不需要任何新的非阻塞的系统调用
* 进程中线程引起的页面故障好检查。

缺点：系统调用花销巨大

### 用户级线程

* 不依赖于操作系统核心，由应用进程利用线程库提供创建、同步、调度和管理线程的函数来控制线程
* 维护由应用程序完成
* 用户级线程对 OS 不可见，OS 调度的依然是进程
* 调度线程不涉及模式切换
  * 由线程库来切换：TCB、PC、寄存器、运行栈
  * 优势：速度快
* 限制：
  * 当一个线程阻塞时，整个进程必须等待
  * 处理机时间分配的对象是进程，进程内有多个线程时、每个线程执行时间减少

#### 优缺点——用户级线程

优点：

* 快
  * 堆栈指针和计数器被切换，新的进程就自动投入运行
* 允许每个进程拥有自己的调度算法；
* 切换成本小：用户空间程序可以自己维护，不需要走操作系统调度。

缺点：

* 线程间协作成本高
* 一个线程开始运行，该进程中的其他线程就不能运行，除非第一个线程放弃CPU
